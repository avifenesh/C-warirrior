import{b as me,d as Me,f as B,a as P}from"../chunks/BjjLhWhE.js";import{d as be,w as G,c as Se,o as he,a as Ae}from"../chunks/enAchYCB.js";import{l as re,h as M,i as j,d as de,b as ce,g as We,w,a8 as Oe,W as He,X as Pe,Y as we,k as se,m as Y,C as De,aE as Be,aq as Ge,N as K,R as ue,U as ze,aC as Re,F as Ue,a1 as Ve,ai as ye,aK as Fe,aL as Ke,aM as Ye,O as Ie,Q as qe,aN as le,j as Ne,aO as Xe,aP as je,aB as Qe,P as Ze,A as F,K as Je,aQ as $e,aF as et,az as tt,aR as at,aS as rt,aT as st,aU as lt,aV as nt,aI as it,q as ot,Z as dt,aW as ct,z as $,p as pe,B as ee,aH as Q,s as N,c as x,a3 as V,n as Z,r as y,a9 as Te,aX as ut,aY as ft,aZ as vt,aJ as J,f as Le,a as ht,$ as pt}from"../chunks/ftIhdwkj.js";import{p as q,b as xe,i as _e,s as te,a as _t}from"../chunks/CJZO6bo7.js";import{s as gt,h as mt}from"../chunks/4QInlHUM.js";import{d as ge,e as bt,s as U}from"../chunks/C8CwK50t.js";function wt(e,t,a){for(var r=[],v=t.length,i=0;i<v;i++)Xe(t[i].e,r,!0);je(r,()=>{var o=r.length===0&&a!==null;if(o){var s=a,n=s.parentNode;Qe(n),n.append(s),e.items.clear(),H(e,t[0].prev,t[v-1].next)}for(var u=0;u<v;u++){var d=t[u];o||(e.items.delete(d.k),H(e,d.prev,d.next)),Ze(d.e,!o)}e.first===t[0]&&(e.first=t[0].prev)})}function yt(e,t,a,r,v,i=null){var o=e,s=new Map,n=null;{var u=e;o=M?re(j(u)):u.appendChild(de())}M&&ce();var d=null,g=Oe(()=>{var _=a();return Ue(_)?_:_==null?[]:Re(_)}),m,k=!0;function h(){xt(l,m,o,t,r),d!==null&&(m.length===0?(d.fragment?(o.before(d.fragment),d.fragment=null):Ie(d.effect),C.first=d.effect):qe(d.effect,()=>{d=null}))}var C=We(()=>{m=w(g);var _=m.length;let b=!1;if(M){var E=He(o)===Pe;E!==(_===0)&&(o=we(),re(o),se(!1),b=!0)}for(var c=new Set,f=K,p=null,A=ze(),L=0;L<_;L+=1){M&&Y.nodeType===De&&Y.data===Be&&(o=Y,b=!0,se(!1));var W=m[L],T=r(W,L),D=k?null:s.get(T);D?(Ge(D.v,W),D.i=L,A&&f.skipped_effects.delete(D.e)):(D=kt(k?o:null,p,W,T,L,v,t,a),k&&(D.o=!0,p===null?n=D:p.next=D,p=D),s.set(T,D)),c.add(T)}if(_===0&&i&&!d)if(k)d={fragment:null,effect:ue(()=>i(o))};else{var R=document.createDocumentFragment(),I=de();R.append(I),d={fragment:R,effect:ue(()=>i(I))}}if(M&&_>0&&re(we()),!k)if(A){for(const[S,O]of s)c.has(S)||f.skipped_effects.add(O.e);f.oncommit(h),f.ondiscard(()=>{})}else h();b&&se(!0),w(g)}),l={effect:C,items:s,first:n};k=!1,M&&(o=Y)}function xt(e,t,a,r,v){var i=t.length,o=e.items,s=e.first,n,u=null,d=[],g=[],m,k,h,C;for(C=0;C<i;C+=1){if(m=t[C],k=v(m,C),h=o.get(k),e.first??(e.first=h),!h.o){h.o=!0;var l=u?u.next:s;H(e,u,h),H(e,h,l),ne(h,l,a),u=h,d=[],g=[],s=u.next;continue}if(h.e.f&le&&Ie(h.e),h!==s){if(n!==void 0&&n.has(h)){if(d.length<g.length){var _=g[0],b;u=_.prev;var E=d[0],c=d[d.length-1];for(b=0;b<d.length;b+=1)ne(d[b],_,a);for(b=0;b<g.length;b+=1)n.delete(g[b]);H(e,E.prev,c.next),H(e,u,E),H(e,c,_),s=_,u=c,C-=1,d=[],g=[]}else n.delete(h),ne(h,s,a),H(e,h.prev,h.next),H(e,h,u===null?e.first:u.next),H(e,u,h),u=h;continue}for(d=[],g=[];s!==null&&s.k!==k;)s.e.f&le||(n??(n=new Set)).add(s),g.push(s),s=s.next;if(s===null)continue;h=s}d.push(h),u=h,s=h.next}if(s!==null||n!==void 0){for(var f=n===void 0?[]:Re(n);s!==null;)s.e.f&le||f.push(s),s=s.next;var p=f.length;if(p>0){var A=i===0?a:null;wt(e,f,A)}}}function kt(e,t,a,r,v,i,o,s){var n=(o&Ke)!==0,u=(o&Ye)===0,d=n?u?Ve(a,!1,!1):ye(a):a,g=o&Fe?ye(v):v,m={i:g,v:d,k:r,a:null,e:null,o:!1,prev:t,next:null};try{if(e===null){var k=document.createDocumentFragment();k.append(e=de())}return m.e=ue(()=>i(e,d,g,s)),t!==null&&(t.next=m),m}finally{}}function ne(e,t,a){for(var r=e.next?e.next.e.nodes_start:a,v=t?t.e.nodes_start:a,i=e.e.nodes_start;i!==null&&i!==r;){var o=Ne(i);v.before(i),i=o}}function H(e,t,a){t===null?(e.first=a,e.effect.first=a&&a.e):(t.e.next&&(t.e.next.prev=null),t.next=a,t.e.next=a&&a.e),a===null?e.effect.last=t&&t.e:(a.e.prev&&(a.e.prev.next=null),a.prev=t,a.e.prev=t&&t.e)}function Ct(e,t,a=!1,r=!1,v=!1){var i=e,o="";F(()=>{var s=Je;if(o===(o=t()??"")){M&&ce();return}if(s.nodes_start!==null&&($e(s.nodes_start,s.nodes_end),s.nodes_start=s.nodes_end=null),o!==""){if(M){Y.data;for(var n=ce(),u=n;n!==null&&(n.nodeType!==De||n.data!=="");)u=n,n=Ne(n);if(n===null)throw et(),tt;me(Y,u),i=re(n);return}var d=o+"";a?d=`<svg>${d}</svg>`:r&&(d=`<math>${d}</math>`);var g=Me(d);if((a||r)&&(g=j(g)),me(j(g),g.lastChild),a||r)for(;j(g);)i.before(j(g));else i.before(g)}})}function Et(e,t,a){var r=e==null?"":""+e;return t&&(r=r?r+" "+t:t),r===""?null:r}function St(e,t){return e==null?null:String(e)}function fe(e,t,a,r,v,i){var o=e.__className;if(M||o!==a||o===void 0){var s=Et(a,r);(!M||s!==e.getAttribute("class"))&&(s==null?e.removeAttribute("class"):e.className=s),e.__className=a}return i}function ke(e,t,a,r){var v=e.__style;if(M||v!==t){var i=St(t);(!M||i!==e.getAttribute("style"))&&(i==null?e.removeAttribute("style"):e.style.cssText=i),e.__style=t}return r}const At=Symbol("is custom element"),Dt=Symbol("is html");function ve(e,t,a,r){var v=Rt(e);M&&(v[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||v[t]!==(v[t]=a)&&(t==="loading"&&(e[at]=a),a==null?e.removeAttribute(t):typeof a!="string"&&It(e).includes(t)?e[t]=a:e.setAttribute(t,a))}function Rt(e){return e.__attributes??(e.__attributes={[At]:e.nodeName.includes("-"),[Dt]:e.namespaceURI===rt})}var Ce=new Map;function It(e){var t=e.getAttribute("is")||e.nodeName,a=Ce.get(t);if(a)return a;Ce.set(t,a=[]);for(var r,v=e,i=Element.prototype;i!==v;){r=lt(v);for(var o in r)r[o].set&&a.push(o);v=st(v)}return a}function Nt(e,t,a=t){var r=new WeakSet;nt(e,"input",async v=>{var i=v?e.defaultValue:e.value;if(i=ie(e)?oe(i):i,a(i),K!==null&&r.add(K),await it(),i!==(i=t())){var o=e.selectionStart,s=e.selectionEnd,n=e.value.length;if(e.value=i??"",s!==null){var u=e.value.length;o===s&&s===n&&u>n?(e.selectionStart=u,e.selectionEnd=u):(e.selectionStart=o,e.selectionEnd=Math.min(s,u))}}}),(M&&e.defaultValue!==e.value||ot(t)==null&&e.value)&&(a(ie(e)?oe(e.value):e.value),K!==null&&r.add(K)),dt(()=>{var v=t();if(e===document.activeElement){var i=ct??K;if(r.has(i))return}ie(e)&&v===oe(e.value)||e.type==="date"&&!v&&!e.value||v!==e.value&&(e.value=v??"")})}function ie(e){var t=e.type;return t==="number"||t==="range"}function oe(e){return e===""?null:+e}function Tt(e,t=!1){return window.__TAURI_INTERNALS__.transformCallback(e,t)}async function z(e,t={},a){return window.__TAURI_INTERNALS__.invoke(e,t,a)}var Ee;(function(e){e.WINDOW_RESIZED="tauri://resize",e.WINDOW_MOVED="tauri://move",e.WINDOW_CLOSE_REQUESTED="tauri://close-requested",e.WINDOW_DESTROYED="tauri://destroyed",e.WINDOW_FOCUS="tauri://focus",e.WINDOW_BLUR="tauri://blur",e.WINDOW_SCALE_FACTOR_CHANGED="tauri://scale-change",e.WINDOW_THEME_CHANGED="tauri://theme-changed",e.WINDOW_CREATED="tauri://window-created",e.WEBVIEW_CREATED="tauri://webview-created",e.DRAG_ENTER="tauri://drag-enter",e.DRAG_OVER="tauri://drag-over",e.DRAG_DROP="tauri://drag-drop",e.DRAG_LEAVE="tauri://drag-leave"})(Ee||(Ee={}));async function Lt(e,t){window.__TAURI_EVENT_PLUGIN_INTERNALS__.unregisterListener(e,t),await z("plugin:event|unlisten",{event:e,eventId:t})}async function ae(e,t,a){var r;const v=(r=void 0)!==null&&r!==void 0?r:{kind:"Any"};return z("plugin:event|listen",{event:e,target:v,handler:Tt(t)}).then(i=>async()=>Lt(e,i))}const Mt="Waiting for backend tick...";function Wt(){const e=G(null),t=G({loading:!0,status:"Booting Code Warrior...",error:null}),a=G([]),r=G(null),v=G(null),i=G(!1),o=G(null);let s=null,n=null,u=null,d=null;async function g(){t.update(c=>({...c,loading:!0,status:"Resetting backend state...",error:null}));try{await z("init_game"),t.update(c=>({...c,status:Mt})),await m(),await k()}catch(c){t.update(f=>({...f,error:X(c)}))}finally{t.update(c=>({...c,loading:!1}))}}async function m(){try{const c=await z("get_available_levels");a.set(c)}catch(c){t.update(f=>({...f,error:f.error??X(c)}))}}async function k(){s||(s=await ae("game_tick",c=>{e.set(c.payload),t.update(f=>({...f,status:"Live"}))})),n||(n=await ae("game_error",c=>{t.update(f=>({...f,error:c.payload.message}))})),u||(u=await ae("code_output",c=>{r.set(c.payload)})),d||(d=await ae("level_complete",c=>{v.set(c.payload)}))}async function h(c){t.update(f=>({...f,loading:!0,status:`Loading ${c}...`,error:null}));try{await z("load_level",{levelId:c}),t.update(f=>({...f,status:`Level ${c} loaded`}))}catch(f){t.update(p=>({...p,error:X(f)}))}finally{t.update(f=>({...f,loading:!1}))}}async function C(c){t.update(f=>({...f,error:null}));try{const f=await z("process_action",{action:c});e.set(f)}catch(f){t.update(p=>({...p,error:X(f)}))}}async function l(c){t.update(f=>({...f,error:null})),i.set(!0);try{const f=await z("submit_code",{code:c});o.set(f)}catch(f){t.update(p=>({...p,error:X(f)}))}finally{i.set(!1)}}const _=be(e,c=>(c==null?void 0:c.game_phase)??"main_menu"),b=be(e,c=>(c==null?void 0:c.current_level_id)??null);function E(){s==null||s(),n==null||n(),u==null||u(),d==null||d()}return{renderState:e,ui:t,levels:a,lastCodeOutput:r,lastLevelComplete:v,phase:_,currentLevelId:b,codeSubmitting:i,lastCodeResult:o,boot:g,startLevel:h,sendAction:C,submitCode:l,refreshLevels:m,cleanup:E}}function X(e){return e instanceof Error?e.message:typeof e=="string"?e:"Unknown error"}const Ot=Wt();var Ht=B('<div class="relative min-h-screen w-full bg-slate-950 outline-none svelte-ec6f7e" tabindex="-1" role="application" aria-label="Game world"><div class="flex items-center justify-center min-h-screen p-8 svelte-ec6f7e"><div class="relative svelte-ec6f7e"><canvas class="rounded-2xl border-2 border-slate-800 shadow-2xl shadow-slate-950/50" aria-label="Game viewport"></canvas> <div class="pointer-events-none absolute inset-0 rounded-2xl svelte-ec6f7e" style="box-shadow: inset 0 0 100px 40px rgba(2, 6, 23, 0.5);"></div></div></div> <!></div>');function Pt(e,t){$(t,!0);let a=q(t,"renderState",3,null),r=q(t,"tileSize",3,32);const v=Se();let i=Q(null),o=Q(null);function s(l){const _=l.key.toLowerCase(),b={w:"up",arrowup:"up",a:"left",arrowleft:"left",s:"down",arrowdown:"down",d:"right",arrowright:"right"};b[_]&&(l.preventDefault(),v("move",{direction:b[_]})),(_==="e"||_===" ")&&(l.preventDefault(),v("interact"))}he(()=>{var l;window.addEventListener("keydown",s),(l=w(o))==null||l.focus()}),Ae(()=>{window.removeEventListener("keydown",s)}),pe(()=>{if(!w(i))return;const l=w(i).getContext("2d");l&&(l.imageSmoothingEnabled=!1,n(l,a()))});function n(l,_){var T,D;const b=((T=w(i))==null?void 0:T.width)??0,E=((D=w(i))==null?void 0:D.height)??0;if(l.fillStyle="#020617",l.fillRect(0,0,b,E),!_){l.fillStyle="#64748b",l.font='16px "IBM Plex Mono", monospace',l.textAlign="center",l.fillText("Initializing world...",b/2,E/2);return}for(let R=0;R<_.visible_tiles.length;R++)for(let I=0;I<_.visible_tiles[R].length;I++){const S=_.visible_tiles[R][I];l.fillStyle=u(S.tile_type),l.fillRect(I*r(),R*r(),r(),r()),l.strokeStyle="rgba(148, 163, 184, 0.05)",l.lineWidth=1,l.strokeRect(I*r(),R*r(),r(),r()),S.tile_type==="terminal"&&(l.shadowBlur=10,l.shadowColor="#22c55e",l.strokeStyle="#22c55e",l.lineWidth=2,l.strokeRect(I*r()+2,R*r()+2,r()-4,r()-4),l.shadowBlur=0)}const c=_.player.position.x-_.viewport_offset.x*r(),f=_.player.position.y-_.viewport_offset.y*r();l.shadowBlur=15,l.shadowColor="#22d3ee",l.fillStyle="#22d3ee",l.beginPath(),l.arc(c,f,r()*.35,0,Math.PI*2),l.fill(),l.shadowBlur=0,l.strokeStyle="#0ea5e9",l.lineWidth=3;const p=_.player.facing,A=r()*.5,L=p==="left"?-A:p==="right"?A:0,W=p==="up"?-A:p==="down"?A:0;l.beginPath(),l.moveTo(c,f),l.lineTo(c+L,f+W),l.stroke()}function u(l){switch(l){case"wall":return"#1e293b";case"water":return"#0c4a6e";case"void":return"#020617";case"door":return"#78350f";case"terminal":return"#14532d";case"floor":default:return"#0f172a"}}function d(){var l;(l=w(o))==null||l.focus()}var g=Ht();g.__click=d;var m=x(g),k=x(m),h=x(k);xe(h,l=>V(i,l),()=>w(i)),Z(2),y(k),y(m);var C=N(m,2);gt(C,t,"default",{}),y(g),xe(g,l=>V(o,l),()=>w(o)),F(()=>{ve(h,"width",r()*20),ve(h,"height",r()*15)}),P(e,g),ee()}ge(["click"]);var Bt=B('<div class="fixed inset-0 z-50 flex items-center justify-center bg-slate-950/80 backdrop-blur-sm svelte-1hxo5d7"><div class="relative w-full max-w-4xl rounded-2xl border-2 border-cyan-500/50 bg-slate-900/95 shadow-2xl shadow-cyan-500/20 backdrop-blur-md svelte-1hxo5d7"><div class="flex items-center justify-between border-b border-cyan-500/30 bg-slate-950/50 px-6 py-4 svelte-1hxo5d7"><div class="flex items-center gap-3 svelte-1hxo5d7"><div class="flex gap-2 svelte-1hxo5d7"><div class="h-3 w-3 rounded-full bg-rose-500/50 svelte-1hxo5d7"></div> <div class="h-3 w-3 rounded-full bg-amber-500/50 svelte-1hxo5d7"></div> <div class="h-3 w-3 rounded-full bg-emerald-500/50 svelte-1hxo5d7"></div></div> <h2 class="font-mono text-sm uppercase tracking-widest text-cyan-400 svelte-1hxo5d7">// Code Terminal</h2></div> <button class="text-slate-400 hover:text-slate-200 transition-colors svelte-1hxo5d7" aria-label="Close terminal"><svg class="h-6 w-6 svelte-1hxo5d7" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-1hxo5d7"></path></svg></button></div> <div class="p-6 svelte-1hxo5d7"><div class="relative rounded-xl border-2 border-slate-800 bg-slate-950 p-4 shadow-inner svelte-1hxo5d7"><pre class="pointer-events-none absolute inset-4 m-0 overflow-auto whitespace-pre-wrap font-mono text-sm leading-relaxed text-slate-200 svelte-1hxo5d7" aria-hidden="true"><code class="svelte-1hxo5d7"><!></code></pre> <textarea class="relative h-96 w-full resize-none bg-transparent font-mono text-sm text-transparent caret-cyan-300 outline-none svelte-1hxo5d7" spellcheck="false"></textarea> <div class="absolute inset-0 pointer-events-none overflow-hidden rounded-xl svelte-1hxo5d7"><div class="terminal-scan-line svelte-1hxo5d7"></div></div></div> <div class="mt-4 flex items-center justify-between svelte-1hxo5d7"><p class="text-xs font-mono text-slate-500 svelte-1hxo5d7"><kbd class="px-2 py-1 rounded bg-slate-800 text-cyan-400 svelte-1hxo5d7">ESC</kbd> to close | <kbd class="px-2 py-1 rounded bg-slate-800 text-cyan-400 svelte-1hxo5d7">Ctrl+Enter</kbd> to cast spell</p> <button class="rounded-lg border-2 border-cyan-500/50 bg-cyan-500/10 px-6 py-2 font-semibold text-cyan-300 transition-all hover:border-cyan-400 hover:bg-cyan-500/20 hover:text-cyan-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-cyan-500/20 svelte-1hxo5d7"> </button></div></div> <div class="absolute inset-0 pointer-events-none rounded-2xl svelte-1hxo5d7"><div class="glow-pulse svelte-1hxo5d7"></div></div></div></div>');function Gt(e,t){$(t,!0);let a=q(t,"initialCode",3,""),r=q(t,"placeholder",3,"// Cast your spell..."),v=q(t,"submitting",3,!1);const i=Se();let o=Q(Te(a()));pe(()=>{V(o,a())});const s=/\b(int|float|double|char|void|return|if|else|for|while|do|switch|case|break|continue|struct|typedef|const|printf|scanf|malloc|free|sizeof|include|define)\b/g,n=/\b(0x[\da-fA-F]+|\d+(?:\.\d+)?)\b/g,u=/"(?:[^"\\]|\\.)*"/g,d=/\/\/.*$/gm;function g(S){return S.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function m(S){let O=g(S);return O=O.replace(d,'<span class="text-slate-500">$&</span>'),O=O.replace(u,'<span class="text-emerald-300">$&</span>'),O=O.replace(s,'<span class="text-cyan-300">$1</span>'),O=O.replace(n,'<span class="text-amber-300">$1</span>'),O}const k=J(()=>m(w(o)));function h(){i("submit",{code:w(o)})}function C(){t.onClose&&t.onClose()}function l(S){S.key==="Escape"&&t.onClose&&(S.preventDefault(),C()),(S.ctrlKey||S.metaKey)&&S.key==="Enter"&&(S.preventDefault(),h())}var _=Bt();bt("keydown",vt,l);var b=x(_),E=x(b),c=N(x(E),2);c.__click=C,y(E);var f=N(E,2),p=x(f),A=x(p),L=x(A),W=x(L);Ct(W,()=>w(k)),y(L),y(A);var T=N(A,2);ut(T),ft(T),Z(2),y(p);var D=N(p,2),R=N(x(D),2);R.__click=h;var I=x(R,!0);y(R),y(D),y(f),Z(2),y(b),y(_),F(()=>{ve(T,"placeholder",r()),R.disabled=v(),U(I,v()?"Casting Spell...":"âš¡ Cast Spell")}),Nt(T,()=>w(o),S=>V(o,S)),P(e,_),ee()}ge(["click"]);var zt=B('<div class="rounded-lg border border-slate-700/50 bg-slate-900/80 p-3 backdrop-blur-sm shadow-lg"><div class="mb-2 flex items-center justify-between"><p class="text-xs uppercase tracking-widest text-slate-400">Health</p> <p class="text-xs font-mono text-slate-300"> </p></div> <div class="h-3 w-48 overflow-hidden rounded-full bg-slate-800 border border-slate-700"><div></div></div></div> <div class="rounded-lg border border-slate-700/50 bg-slate-900/80 p-3 backdrop-blur-sm shadow-lg"><div class="mb-2 flex items-center justify-between"><p class="text-xs uppercase tracking-widest text-slate-400">XP <span class="ml-1 text-cyan-400"> </span></p> <p class="text-xs font-mono text-slate-300"> </p></div> <div class="h-3 w-48 overflow-hidden rounded-full bg-slate-800 border border-slate-700"><div class="h-full bg-gradient-to-r from-cyan-500 to-blue-500 transition-all duration-300 shadow-lg shadow-cyan-500/50"></div></div></div>',1),Ut=B('<div class="pointer-events-none fixed left-4 top-4 z-40 space-y-3"><div class="rounded-lg border border-cyan-500/30 bg-slate-900/80 px-4 py-2 backdrop-blur-sm shadow-lg shadow-cyan-500/10"><p class="text-xs uppercase tracking-widest text-cyan-400">Level</p> <p class="text-2xl font-bold text-cyan-200"> </p></div> <!> <div class="absolute inset-0 pointer-events-none overflow-hidden rounded-lg"><div class="hud-scan-line svelte-7ggbmv"></div></div></div>');function Vt(e,t){$(t,!0);let a=J(()=>t.player?Math.max(0,Math.min(100,t.player.health/t.player.max_health*100)):0),r=J(()=>t.player?t.player.xp%100:0);function v(m){return m>66?"bg-emerald-500":m>33?"bg-amber-500":"bg-rose-500"}function i(m){return m>66?"shadow-emerald-500/50":m>33?"shadow-amber-500/50":"shadow-rose-500/50"}var o=Ut(),s=x(o),n=N(x(s),2),u=x(n,!0);y(n),y(s);var d=N(s,2);{var g=m=>{var k=zt(),h=Le(k),C=x(h),l=N(x(C),2),_=x(l);y(l),y(C);var b=N(C,2),E=x(b);y(b),y(h);var c=N(h,2),f=x(c),p=x(f),A=N(x(p)),L=x(A);y(A),y(p);var W=N(p,2),T=x(W);y(W),y(f);var D=N(f,2),R=x(D);y(D),y(c),F((I,S)=>{U(_,`${t.player.health??""}/${t.player.max_health??""}`),fe(E,1,`h-full transition-all duration-300 shadow-lg ${I??""} ${S??""}`,"svelte-7ggbmv"),ke(E,`width: ${w(a)??""}%`),U(L,`Lv.${t.player.level??""}`),U(T,`${w(r)??""}/100`),ke(R,`width: ${w(r)??""}%`)},[()=>v(w(a)),()=>i(w(a))]),P(m,k)};_e(d,m=>{t.player&&m(g)})}Z(2),y(o),F(()=>U(u,t.currentLevelId??"--")),P(e,o),ee()}var Ft=B('<p class="mt-1 text-xs font-mono text-slate-400 whitespace-pre-wrap"> </p>'),Kt=B('<div><div class="flex items-start justify-between gap-3"><div class="flex-1"><p> </p> <!></div> <button class="text-slate-400 hover:text-slate-200 transition-colors" aria-label="Dismiss"><svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="absolute inset-0 pointer-events-none overflow-hidden rounded-lg"><div class="scan-line svelte-1cpok13"></div></div></div>'),Yt=B('<div class="pointer-events-none fixed bottom-4 right-4 z-50 flex flex-col gap-3"></div>');function qt(e,t){$(t,!0);let a=q(t,"messages",19,()=>[]);he(()=>{a().forEach(n=>{setTimeout(()=>{t.onDismiss&&t.onDismiss(n.id)},3e3)})});function r(n){t.onDismiss&&t.onDismiss(n)}function v(n){switch(n){case"success":return"border-emerald-500/50";case"error":return"border-rose-500/50";default:return"border-cyan-500/50"}}function i(n){switch(n){case"success":return"shadow-emerald-500/20";case"error":return"shadow-rose-500/20";default:return"shadow-cyan-500/20"}}function o(n){switch(n){case"success":return"text-emerald-300";case"error":return"text-rose-300";default:return"text-cyan-300"}}var s=Yt();yt(s,21,a,n=>n.id,(n,u)=>{var d=Kt(),g=x(d),m=x(g),k=x(m),h=x(k,!0);y(k);var C=N(k,2);{var l=b=>{var E=Ft(),c=x(E,!0);y(E),F(()=>U(c,w(u).details)),P(b,E)};_e(C,b=>{w(u).details&&b(l)})}y(m);var _=N(m,2);_.__click=()=>r(w(u).id),y(g),Z(2),y(d),F((b,E,c)=>{fe(d,1,`pointer-events-auto animate-slide-in rounded-lg border-2 bg-slate-900/95 p-4 shadow-lg backdrop-blur-sm transition-all ${b??""} ${E??""}`,"svelte-1cpok13"),fe(k,1,`font-semibold ${c??""}`,"svelte-1cpok13"),U(h,w(u).message)},[()=>v(w(u).type),()=>i(w(u).type),()=>o(w(u).type)]),P(n,d)}),y(s),P(e,s),ee()}ge(["click"]);var Xt=B("<!> <!> <!>",1);function ta(e,t){$(t,!0);const a=()=>te(g,"$renderState",o),r=()=>te(h,"$lastCodeResult",o),v=()=>te(m,"$currentLevelId",o),i=()=>te(k,"$codeSubmitting",o),[o,s]=_t(),n=Ot;let u=Q(`// Write your C spell here...
#include <stdio.h>

int main() {
    printf("Hello, World!\\n");
    return 0;
}`),d=Q(Te([]));const{renderState:g,currentLevelId:m,codeSubmitting:k,lastCodeResult:h}=n;let C=J(()=>{var p;return((p=a())==null?void 0:p.show_terminal)??!1});he(()=>{n.boot()}),Ae(()=>{n.cleanup()});function l(p){n.sendAction({type:"move",direction:p.detail.direction})}function _(){n.sendAction({type:"interact"})}async function b(p){V(u,p.detail.code,!0),await n.submitCode(w(u))}pe(()=>{r()&&c(r())});function E(){n.sendAction({type:"resume"})}function c(p){const A={id:`toast-${Date.now()}`,type:p.success?"success":"error",message:p.success?"Spell cast successfully!":"Spell failed",details:p.compile_error||p.feedback||p.stdout||void 0};V(d,[...w(d),A],!0)}function f(p){V(d,w(d).filter(A=>A.id!==p),!0)}mt("1uha8ag",p=>{ht(()=>{pt.title="Code Warrior: C Mastery"})}),Pt(e,{get renderState(){return a()},$$events:{move:l,interact:_},children:(p,A)=>{var L=Xt(),W=Le(L);{let I=J(()=>{var S;return((S=a())==null?void 0:S.player)??null});Vt(W,{get player(){return w(I)},get currentLevelId(){return v()}})}var T=N(W,2);{var D=I=>{Gt(I,{get initialCode(){return w(u)},get submitting(){return i()},onClose:E,$$events:{submit:b}})};_e(T,I=>{w(C)&&I(D)})}var R=N(T,2);qt(R,{get messages(){return w(d)},onDismiss:f}),P(p,L)},$$slots:{default:!0}}),ee(),s()}export{ta as component};
